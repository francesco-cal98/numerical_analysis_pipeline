# =============================================================================
# GROUNDEEP Modular Analysis Pipeline (Groundeep assets)
# =============================================================================

# Global Settings
seed: 42
use_wandb: false
wandb_project: numerosity-offline
output_root: ../results/groundeep
val_size: 0.05
anchor: 0

# Filter numerosity range
numerosity_filter:
  min: 5

# Layer Configuration
layers: top  # Options: 'top' | 'all' | [1, 2, 3]

# =============================================================================
# ANALYSIS STAGES
# =============================================================================

probing:
  enabled: true
  layers: [top]
  n_bins: 5
  test_size: 0.2
  steps: 1000
  lr: 0.01
  patience: 20

rsa:
  enabled: true
  alpha: 0.01
  metric: cosine
  dump_rdms: false

rdm:
  enabled: true
  metrics: [cosine, euclidean]

monotonicity:
  enabled: true

partial_rsa:
  enabled: true

mse:
  enabled: true
  n_bins: 5

afp:
  enabled: true
  n_bins: 5

ssim:
  enabled: true
  n_bins: 5

pca_geometry:
  enabled: true
  per_class: 200
  isomap: false

pca_report:
  enabled: true
  random_state: 42

tsne:
  enabled: false
  perplexity: 30
  n_iter: 1000
  max_samples: 5000
  random_state: 42

umap:
  enabled: true
  n_neighbors: 15
  min_dist: 0.1
  max_samples: 5000
  random_state: 42

reductions:
  pca:   {enabled: true}
  tsne:  {enabled: false}
  mds:   {enabled: false}
  umap:  {enabled: true}

traversal:
  enabled: true
  pcs: [0, 1]
  steps: 7
  delta: 2.0

cka:
  enabled: false
  kernels: [linear]
  n_max: 1024
  report:
    enabled: true
    bootstrap: 0
    null_permutations: 0
  permutation:
    enabled: false
    n_perm: 200

behavioral:
  enabled: false
  train_pickle: local_assets/behavioral_datasets/binary_de_wind_train.pkl
  test_pickle: local_assets/behavioral_datasets/binary_de_wind_test.pkl
  mat_file: local_assets/circle_dataset_100x100/NumStim_7to28_100x100_TE.mat
  guess_rate: 0.01
  tasks:
    comparison:
      enabled: true
      guess_rate: 0.01
      train_pickle: local_assets/behavioral_datasets/binary_de_wind_train.pkl
      test_pickle: local_assets/behavioral_datasets/binary_de_wind_test.pkl
      mat_file: local_assets/circle_dataset_100x100/NumStim_7to28_100x100_TE.mat
    fixed_reference:
      enabled: true
      references: [8, 14, 16, 20]
      train_template: local_assets/behavioral_datasets/fixed_ref_REF_{ref}_train.pkl
      test_template: local_assets/behavioral_datasets/fixed_ref_REF_{ref}_test.pkl
      mat_file: local_assets/circle_dataset_100x100/NumStim_1to32_100x100_TE.mat
      guess_rate: 0.01
    estimation:
      enabled: true
      datasets:
        uniform:
          train_pickle: local_assets/behavioral_datasets/naming_train.pkl
          test_pickle: local_assets/behavioral_datasets/naming_test.pkl
        zipfian:
          train_pickle: local_assets/behavioral_datasets/naming_train.pkl
          test_pickle: local_assets/behavioral_datasets/naming_test.pkl
      classifiers: [SGD_regression]
      label_mode: int
      scale_targets: false
      max_display_classes: 32

# =============================================================================
# MODEL CONFIGURATIONS
# =============================================================================

models:
  - arch: iDBN_1500_500
    distribution: uniform
    dataset_path: ../../local_assets/stimuli_dataset_10_10
    dataset_name: stimuli_dataset.npz
    model_uniform: ../../local_assets/networks/uniform/dataset_10_10/uniform_i_/dbn_trained_uniform_1500_500.pkl
    model_zipfian: ../../local_assets/networks/zipfian/dataset_10_10/zipfian_i_/dbn_trained_zipfian_1500_500.pkl
    val_size: 0.10

  - arch: iDBN_1500_500
    distribution: zipfian
    dataset_path: ../../local_assets/stimuli_dataset_10_10
    dataset_name: stimuli_dataset.npz
    model_uniform: ../../local_assets/networks/uniform/dataset_10_10/uniform_i_/dbn_trained_uniform_1500_500.pkl
    model_zipfian: ../../local_assets/networks/zipfian/dataset_10_10/zipfian_i_/dbn_trained_zipfian_1500_500.pkl
    val_size: 0.10
